@model List<Bevera.Models.Catalog.Product>

@{
    ViewData["Title"] = "Търсене";
    var q = ViewBag.Q as string;
}

<div class="container py-4">
    <h2 class="mb-2">Търсене</h2>

    @if (!string.IsNullOrWhiteSpace(q))
    {
        <div class="text-muted mb-3">Резултати за: <strong>@q</strong></div>
    }
    else
    {
        <div class="text-muted mb-3">Въведи поне 2 символа.</div>
    }

    @if (Model.Count == 0)
    {
        <div class="alert alert-light border">Няма намерени продукти.</div>
    }
    else
    {
        <div class="row g-3">
            @foreach (var p in Model)
            {
                var img = p.Images?.OrderByDescending(i => i.IsMain).Select(i => i.ImagePath).FirstOrDefault();

                <div class="col-6 col-md-4 col-lg-3">
                    <a class="product-card" asp-controller="Client" asp-action="Product" asp-route-id="@p.Id">
                        <div class="product-img">
                            @if (!string.IsNullOrWhiteSpace(img))
                            {
                                <img src="@img" alt="@p.Name" />
                            }
                        </div>
                        <div class="product-body">
                            <div class="product-name">@p.Name</div>
                            <div class="product-price">@p.Price.ToString("0.00") €</div>

                            @if (p.StockQty > 0)
                            {
                                <div class="product-stock in">В наличност</div>
                            }
                            else
                            {
                                <div class="product-stock out">Няма наличност</div>
                            }
                        </div>
                    </a>
                </div>
            }
        </div>
    }
</div>
